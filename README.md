# Karabo-Feedstock

This repository builds the conda-dependencies for the [Karabo pipeline](https://github.com/i4Ds/Karabo-Pipeline) so that conda-wheel of the pipeline can be built. To do this, the individual packages must be triggered by `build * dependenc(y/ies) *` workflows, which orchestrate other workflows located in this repository. Since the number of workflows to be called is limited to 20 by GitHub, the whole process can unfortunately not be handled in a single workflow. There are two different kind of builds to consider:

**Main builds** are Conda packages which are needed for a Karabo build. These packages should have the `main` label, so that they can be installed without additional referencing of another channel. If the release number is greater than previous releases, the package automatically becomes `latest`.

**Dev builds** are Conda packages, which are used for the development of Karabo, but should not appear under `latest`. The naming convention is [PEP 440](https://peps.python.org/pep-0440/) compliant: `{MAJOR}.{MINOR}.dev{PATCH}`, which is automatically formed this way if the `dev` flag is set when starting the workflow. The current setup calls for the builds to have the `main` label as well. This must be compatible with the [environment.yaml](https://github.com/i4Ds/Karabo-Pipeline/blob/main/environment.yaml) of the Karabo pipeline, where they can easily be referenced.

**Version number management** (not dev) of the packages to be built is usually handled by the `build base (build_base.yml)` super workflow. In it, the versions of the packages can be updated to a newer version. **Important:** There are some packages where version changes also require adjustments in the `conda build-recipe`, for example in `meta.yaml`. In it can be e.g. fixed git-tag/rev or dependencies, which do not correspond any more with the updated version of the package to be built. The individual builds with version changes must be tested beforehand, before going into a Karabo release.

**Branch management** should be followed to support any legacy builds of packages. A new branch should be created for each update of a package. Furthermore, the PR should contain `{package-name}-{version}` at the beginning of the commit message to make it easier to find older builds if necessary.
